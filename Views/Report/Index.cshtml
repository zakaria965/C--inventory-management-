@{
    ViewData["Title"] = "Reports";
    Layout = "_DashboardLayout";
}

<div class="container">
    <h1 style="margin-bottom: 30px;">Reports & Analytics</h1>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success" style="padding: 12px 20px; margin-bottom: 20px; border: 1px solid transparent; border-radius: 4px; color: #155724; background-color: #d4edda; border-color: #c3e6cb;">
            @TempData["Success"]
        </div>
    }

    @if (TempData["Error"] != null)
    {
        <div class="alert alert-danger" style="padding: 12px 20px; margin-bottom: 20px; border: 1px solid transparent; border-radius: 4px; color: #721c24; background-color: #f8d7da; border-color: #f5c6cb;">
            @TempData["Error"]
        </div>
    }

    <!-- KPI Cards Section -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
        <div class="kpi-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); color: white; position: relative; overflow: hidden;">
            <div style="position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
            <div style="position: relative; z-index: 1;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <i class="fas fa-box" style="font-size: 32px; opacity: 0.9;"></i>
                    <span style="font-size: 14px; opacity: 0.9;">Total Products</span>
                </div>
                <h2 style="margin: 0; font-size: 36px; font-weight: bold;">@ViewBag.TotalProducts</h2>
            </div>
        </div>

        <div class="kpi-card" style="background: linear-gradient(135deg, #0e0110ff 0%, #190104ff 100%); padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); color: white; position: relative; overflow: hidden;">
            <div style="position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
            <div style="position: relative; z-index: 1;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <i class="fas fa-shopping-cart" style="font-size: 32px; opacity: 0.9;"></i>
                    <span style="font-size: 14px; opacity: 0.9;">Total Orders</span>
                </div>
                <h2 style="margin: 0; font-size: 36px; font-weight: bold;">@ViewBag.TotalOrders</h2>
            </div>
        </div>

        <div class="kpi-card" style="background: linear-gradient(135deg, #4facfe 0%, #114b2bff 100%); padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); color: white; position: relative; overflow: hidden;">
            <div style="position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
            <div style="position: relative; z-index: 1;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <i class="fas fa-users" style="font-size: 32px; opacity: 0.9;"></i>
                    <span style="font-size: 14px; opacity: 0.9;">Employees</span>
                </div>
                <h2 style="margin: 0; font-size: 36px; font-weight: bold;">@ViewBag.TotalEmployees</h2>
            </div>
        </div>

        <div class="kpi-card" style="background: linear-gradient(135deg, #31bf5bff 0%, #da1212ff 100%); padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); color: white; position: relative; overflow: hidden;">
            <div style="position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
            <div style="position: relative; z-index: 1;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <i class="fas fa-truck" style="font-size: 32px; opacity: 0.9;"></i>
                    <span style="font-size: 14px; opacity: 0.9;">Suppliers</span>
                </div>
                <h2 style="margin: 0; font-size: 36px; font-weight: bold;">@ViewBag.TotalSuppliers</h2>
            </div>
        </div>

        <div class="kpi-card" style="background: linear-gradient(135deg, #170208ff 0%, #fee140 100%); padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); color: white; position: relative; overflow: hidden;">
            <div style="position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%;"></div>
            <div style="position: relative; z-index: 1;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <i class="fas fa-dollar-sign" style="font-size: 32px; opacity: 0.9;"></i>
                    <span style="font-size: 14px; opacity: 0.9;">Inventory Value</span>
                </div>
                <h2 style="margin: 0; font-size: 28px; font-weight: bold;">$@(((decimal)ViewBag.TotalInventoryValue).ToString("N0"))</h2>
            </div>
        </div>

        <div class="kpi-card" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); color: #333; position: relative; overflow: hidden;">
            <div style="position: absolute; top: -30px; right: -30px; width: 100px; height: 100px; background: rgba(255,255,255,0.3); border-radius: 50%;"></div>
            <div style="position: relative; z-index: 1;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <i class="fas fa-exclamation-triangle" style="font-size: 32px; opacity: 0.9; color: #dc3545;"></i>
                    <span style="font-size: 14px; opacity: 0.9;">Low Stock</span>
                </div>
                <h2 style="margin: 0; font-size: 36px; font-weight: bold; color: #dc3545;">@ViewBag.LowStockProducts</h2>
            </div>
        </div>
    </div>

    <!-- Charts Section -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 30px;">
        <!-- Order Status Chart -->
        <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
            <h3 style="color: #2d5a5a; margin-top: 0; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-chart-pie" style="color: #667eea;"></i>
                Order Status Distribution
            </h3>
            <canvas id="orderStatusChart" style="max-height: 300px;"></canvas>
        </div>

        <!-- Product Category Chart -->
        <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
            <h3 style="color: #2d5a5a; margin-top: 0; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-chart-bar" style="color: #f5576c;"></i>
                Products by Category
            </h3>
            <canvas id="categoryChart" style="max-height: 300px;"></canvas>
        </div>

        <!-- Monthly Orders Trend -->
        <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); grid-column: span 2;">
            <h3 style="color: #2d5a5a; margin-top: 0; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-chart-line" style="color: #4facfe;"></i>
                Monthly Orders Trend (Last 6 Months)
            </h3>
            <canvas id="monthlyOrdersChart" style="max-height: 300px;"></canvas>
        </div>

        <!-- Outgoing Reasons Chart -->
        <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
            <h3 style="color: #2d5a5a; margin-top: 0; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-chart-pie" style="color: #43e97b;"></i>
                Outgoing Reasons
            </h3>
            <canvas id="outgoingReasonsChart" style="max-height: 300px;"></canvas>
        </div>
    </div>

    <!-- Report Cards Section -->
    <h2 style="color: #2d5a5a; margin: 40px 0 20px 0;">Export Reports</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; margin-bottom: 30px;">
        <div class="report-card" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); padding: 30px; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); border-left: 5px solid #667eea; transition: transform 0.3s, box-shadow 0.3s;">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-box" style="color: white; font-size: 24px;"></i>
                </div>
                <h3 style="color: #2d5a5a; margin: 0; font-size: 20px;">Inventory Report</h3>
            </div>
            <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">Generate a comprehensive inventory report with all products and stock levels.</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <a href="/Report/Inventory?format=pdf" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3); transition: transform 0.2s;">Export PDF</a>
                <a href="/Report/Inventory?format=excel" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3); transition: transform 0.2s;">Export Excel</a>
                <form method="post" action="/Report/DeleteInventory" style="display: inline;" onsubmit="return confirmDelete('all inventory products');">
                    <button type="submit" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3); transition: transform 0.2s; cursor: pointer;">
                        <i class="fas fa-trash-alt"></i> Delete All
                    </button>
                </form>
            </div>
        </div>

        <div class="report-card" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); padding: 30px; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); border-left: 5px solid #6f42c1; transition: transform 0.3s, box-shadow 0.3s;">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #6f42c1 0%, #007bff 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-truck" style="color: white; font-size: 24px;"></i>
                </div>
                <h3 style="color: #2d5a5a; margin: 0; font-size: 20px;">Supplier Report</h3>
            </div>
            <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">Export supplier information with contact details and status.</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <a href="/Report/Supplier?format=pdf" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3); transition: transform 0.2s;">Export PDF</a>
                <a href="/Report/Supplier?format=excel" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3); transition: transform 0.2s;">Export Excel</a>
                <form method="post" action="/Report/DeleteSuppliers" style="display: inline;" onsubmit="return confirmDelete('all suppliers');">
                    <button type="submit" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3); transition: transform 0.2s; cursor: pointer;">
                        <i class="fas fa-trash-alt"></i> Delete All
                    </button>
                </form>
            </div>
        </div>

        <div class="report-card" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); padding: 30px; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); border-left: 5px solid #4facfe; transition: transform 0.3s, box-shadow 0.3s;">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-arrow-circle-up" style="color: white; font-size: 24px;"></i>
                </div>
                <h3 style="color: #2d5a5a; margin: 0; font-size: 20px;">Outgoing Report</h3>
            </div>
            <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">Track all outgoing product movements and reasons.</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <a href="/Report/Outgoing?format=pdf" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3); transition: transform 0.2s;">Export PDF</a>
                <a href="/Report/Outgoing?format=excel" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3); transition: transform 0.2s;">Export Excel</a>
                <form method="post" action="/Report/DeleteOutgoings" style="display: inline;" onsubmit="return confirmDelete('all outgoing records');">
                    <button type="submit" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3); transition: transform 0.2s; cursor: pointer;">
                        <i class="fas fa-trash-alt"></i> Delete All
                    </button>
                </form>
            </div>
        </div>

        <div class="report-card" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); padding: 30px; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); border-left: 5px solid #43e97b; transition: transform 0.3s, box-shadow 0.3s;">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-file-alt" style="color: white; font-size: 24px;"></i>
                </div>
                <h3 style="color: #2d5a5a; margin: 0; font-size: 20px;">Order Report</h3>
            </div>
            <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">Generate order reports with customer and status information.</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <a href="/Report/Order?format=pdf" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3); transition: transform 0.2s;">Export PDF</a>
                <a href="/Report/Order?format=excel" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3); transition: transform 0.2s;">Export Excel</a>
                <form method="post" action="/Report/DeleteOrders" style="display: inline;" onsubmit="return confirmDelete('all orders');">
                    <button type="submit" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3); transition: transform 0.2s; cursor: pointer;">
                        <i class="fas fa-trash-alt"></i> Delete All
                    </button>
                </form>
            </div>
        </div>

        <div class="report-card" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); padding: 30px; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); border-left: 5px solid #fa709a; transition: transform 0.3s, box-shadow 0.3s;">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-users" style="color: white; font-size: 24px;"></i>
                </div>
                <h3 style="color: #2d5a5a; margin: 0; font-size: 20px;">Employee Report</h3>
            </div>
            <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">Export employee information and details.</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <a href="/Report/Employee?format=pdf" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3); transition: transform 0.2s;">Export PDF</a>
                <a href="/Report/Employee?format=excel" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3); transition: transform 0.2s;">Export Excel</a>
                <form method="post" action="/Report/DeleteEmployees" style="display: inline;" onsubmit="return confirmDelete('all employees');">
                    <button type="submit" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3); transition: transform 0.2s; cursor: pointer;">
                        <i class="fas fa-trash-alt"></i> Delete All
                    </button>
                </form>
            </div>
        </div>

        <div class="report-card" style="background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); padding: 30px; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); border-left: 5px solid #ff9a9e; transition: transform 0.3s, box-shadow 0.3s;">
            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-money-bill-wave" style="color: white; font-size: 24px;"></i>
                </div>
                <h3 style="color: #2d5a5a; margin: 0; font-size: 20px;">Salary Report</h3>
            </div>
            <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">Generate salary reports with paid and unpaid status.</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <a href="/Report/Salary?format=pdf" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3); transition: transform 0.2s;">Export PDF</a>
                <a href="/Report/Salary?format=excel" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 12px 24px; text-decoration: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3); transition: transform 0.2s;">Export Excel</a>
                <form method="post" action="/Report/DeleteSalaries" style="display: inline;" onsubmit="return confirmDelete('all salary records');">
                    <button type="submit" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%); color: white; padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3); transition: transform 0.2s; cursor: pointer;">
                        <i class="fas fa-trash-alt"></i> Delete All
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Chart.js Library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<script>
    function confirmDelete(itemType) {
        return confirm(`⚠️ WARNING: Are you sure you want to delete ${itemType}? This action cannot be undone and will permanently remove all data.`);
    }
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Order Status Pie Chart
        const orderStatusData = @Html.Raw(Json.Serialize(ViewBag.OrderStatusData));
        if (orderStatusData && orderStatusData.length > 0) {
            const orderStatusCtx = document.getElementById('orderStatusChart').getContext('2d');
            new Chart(orderStatusCtx, {
                type: 'doughnut',
                data: {
                    labels: orderStatusData.map(item => item.status),
                    datasets: [{
                        data: orderStatusData.map(item => item.count),
                        backgroundColor: [
                            '#ffc107',
                            '#17a2b8',
                            '#007bff',
                            '#28a745',
                            '#dc3545'
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Product Category Bar Chart
        const categoryData = @Html.Raw(Json.Serialize(ViewBag.CategoryData));
        if (categoryData && categoryData.length > 0) {
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            new Chart(categoryCtx, {
                type: 'bar',
                data: {
                    labels: categoryData.map(item => item.category),
                    datasets: [{
                        label: 'Products',
                        data: categoryData.map(item => item.count),
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(245, 87, 108, 0.8)',
                            'rgba(79, 172, 254, 0.8)',
                            'rgba(67, 233, 123, 0.8)',
                            'rgba(250, 112, 154, 0.8)'
                        ],
                        borderColor: [
                            'rgba(102, 126, 234, 1)',
                            'rgba(245, 87, 108, 1)',
                            'rgba(79, 172, 254, 1)',
                            'rgba(67, 233, 123, 1)',
                            'rgba(250, 112, 154, 1)'
                        ],
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        // Monthly Orders Line Chart
        const monthlyOrders = @Html.Raw(Json.Serialize(ViewBag.MonthlyOrders));
        if (monthlyOrders && monthlyOrders.length > 0) {
            const monthlyCtx = document.getElementById('monthlyOrdersChart').getContext('2d');
            new Chart(monthlyCtx, {
                type: 'line',
                data: {
                    labels: monthlyOrders.map(item => item.month),
                    datasets: [{
                        label: 'Number of Orders',
                        data: monthlyOrders.map(item => item.count),
                        borderColor: 'rgba(79, 172, 254, 1)',
                        backgroundColor: 'rgba(79, 172, 254, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 6,
                        pointBackgroundColor: 'rgba(79, 172, 254, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        // Outgoing Reasons Pie Chart
        const outgoingReasons = @Html.Raw(Json.Serialize(ViewBag.OutgoingReasons));
        if (outgoingReasons && outgoingReasons.length > 0) {
            const outgoingCtx = document.getElementById('outgoingReasonsChart').getContext('2d');
            new Chart(outgoingCtx, {
                type: 'pie',
                data: {
                    labels: outgoingReasons.map(item => item.reason),
                    datasets: [{
                        data: outgoingReasons.map(item => item.count),
                        backgroundColor: [
                            '#28a745',
                            '#dc3545',
                            '#17a2b8',
                            '#ffc107'
                        ],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
    });
</script>

<style>
    .kpi-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
    }

    .report-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.15) !important;
    }

    .report-card a:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0,0,0,0.2) !important;
    }

    .kpi-card, .report-card {
        transition: all 0.3s ease;
    }
</style>
